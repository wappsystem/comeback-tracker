<div id=D__ID>
    <div>
            <!--VmInclude:__HOST__/assets/html/grid.01.questionnaire.html-->
        </div>
    <script>
        function F__ID(){
            //-------------------------------------
            VmInclude:'__HOST__/assets/js/grid.01.js'
            //-------------------------------------
            $('#title__ID').text($vm.module_list[$vm.vm['__ID'].name].task_name);            
            //-------------------------------------
            var fields="_ID,First_Name,Entry_time,"
            fields+="MEALS,ACTIVITY,INACTIVITY,ENERGY,SLEEP,LIFESTYLE,CRAVINGS,FEELING_GOOD,"
            fields+="MEALS_Breakfast,MEALS_Morning_Snack,MEALS_Lunch,MEALS_Afternoon_Snack,MEALS_Dinner,MEALS_Evening_Snack,";
            fields+="ACTIVITY_Walking,ACTIVITY_Running,";
            fields+="INACTIVITY_Sitting,";
            fields+="ENERGY_Up,ENERGY_Down,";
            fields+="SLEEP_Trouble_falling_asleep,SLEEP_Restless_sleep,SLEEP_Woke_up_tired,SLEEP_Fell_asleep_quickly,SLEEP_Stayed_asleep,SLEEP_Woke_up_refreshed,";
            fields+="LIFESTYLE_Alcohol,LIFESTYLE_Smoking,LIFESTYLE_Working_late,LIFESTYLE_Up_late,LIFESTYLE_Big_night,";
            fields+="CRAVINGS_Sweets,CRAVINGS_Salty,CRAVINGS_Fried,CRAVINGS_Spicy,CRAVINGS_Carbs,";
            fields+="FEELING_GOOD_Happy,FEELING_GOOD_Confident,FEELING_GOOD_Excited,FEELING_GOOD_Fulfilled,FEELING_GOOD_Grateful,";
            m.fields="_Form,"+fields+",Submit_date,Submitted_by,_Delete";
            //-------------------------------------
            m.cell_render=function(records,I,field,td,set_value,source){
                switch(field){
                    case '_ID':
                        td.html(records[I].UID);
                        break;
                }
            }
            //-------------------------------------
            $('#part__ID').on('click',function(){
                console.log($('#start_date__ID').val())
                var start=$('#start_date__ID').val().split('-')
                var end=$('#end_date__ID').val().split('-')
				var sy=start[0];
				var smm=start[1]-1;
                var sdd=start[2];
				var ey=end[0];
				var emm=end[1]-1;
                var edd=end[2];
				var t1=new Date(sy,smm,sdd,0,0,0,0).toJSON();
				var t2=new Date(ey,emm,edd,0,0,0,0).toJSON();
				var query={I2:{"$gte":t1,"$lt":t2}}
                var req={api:m.api,cmd:"export",table:m.Table,query:query,search:$('#keyword__ID').val()}
                open_model__ID();
                $vm.request(req,function(N,i,txt){
                    console.log(i+"/"+N);
                    $('#msg__ID').text((100*i/N).toFixed(0)+"%");
                    if(i==-1){
                        var len=txt.length;
                        var n_txt="["+txt.substring(5,len-9)+"]";
                        var o=JSON.parse(n_txt);
                        $vm.download_csv(m.Table+".csv",o);
                        close_model__ID();
                    }
                });
                
            })           
        }
    </script>
    <style>
        /*VmInclude:__HOST__/assets/css/grid.css*/
        /*VmInclude:__HOST__/assets/css/wapp-form.css*/
    </style>
</div>
