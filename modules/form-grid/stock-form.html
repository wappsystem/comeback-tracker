<div id=D__ID>
	<!--third html start -->
	<div class="container mt-95">
		<!-- form container start -->
		<div class="formbox">
			<!-- form start -->
			<form id="F__ID">
				<span id=title__ID></span>
				<!-- form-design name and study id -->
				<div class="formgroup">
					<fieldset class="">
						<div class="grid-container-4">
							<div>
								<label><span class="question">Product Name</span>
									<input type=text name="Product_Name" id="Product_Name__ID" class=formcontrol />
								</label>
							</div>
							<div>
								<label><span class="question">Ingredients ID</span>
									<input type=text name="Ingredients_uid" class=formcontrol readonly />
								</label>
							</div>
							<div>
								<label><span class="question">Format</span>
									<input type=text name="Format" class=formcontrol readonly />
								</label>
							</div>
							<div>
								<label><span class="question">Conversion</span>
									<p id="conversion__ID"></p>
								</label>
							</div>
						</div>
					</fieldset>
				</div>
				<div class="formgroup">
					<fieldset class="">
						<span class="question">
							Current Stock<span></span>
						</span>
						<div class="grid-container-3">
							<div>
								<label><span class="question">Front Storage</span>
									<input type=text name="Front_Storage" class=formcontrol readonly />
								</label>
							</div>
							<div>
								<label><span class="question">Back Storage</span>
									<input type=text name="Back_Storage" class=formcontrol readonly />
								</label>
							</div>
							<div>
								<label><span class="question">Total</span>
									<input type=text name="Total_in_storage" class=formcontrol readonly />
								</label>
							</div>
						</div>
					</fieldset>
				</div>
				<div class="formgroup">
					<div class="questiongroup ">
						<fieldset>
							<span class="question">
								Transaction type
							</span>
							<div class="grid-container-4">
								<div><input id="Transaction_type_2__ID" name="Transaction_type" type="radio"
										value="Put in">
									<label class="rd_btn " for="Transaction_type_2__ID">Put in</label>
								</div>
								<div>
									<input id="Transaction_type_1__ID" name="Transaction_type" type="radio"
										value="Take out">
									<label class="rd_btn " for="Transaction_type_1__ID">Take out</label>
								</div>
								<div><input id="Transaction_type_3__ID" name="Transaction_type" type="radio"
										value="Move">
									<label class="rd_btn " for="Transaction_type_3__ID">Move</label>
								</div>
								<div><input id="Transaction_type_4__ID" name="Transaction_type" type="radio"
										value="Stocktake">
									<label class="rd_btn " for="Transaction_type_4__ID">Stocktake
										Adjustment</label>
								</div>
							</div>
						</fieldset>
					</div>
				</div>
				<div class="formgroup">
					<div class="questiongroup ">
						<fieldset>
							<span class="question">
								Specify Quantity and Date
							</span>
							<div class="grid-container-2">
								<div>
									<label><span class="question" id="quantity__ID">Quantity</span>
										<input type="text" name="Quantity" id="Quantity__ID" class=formcontrol readonly />
									</label>
								</div>
								<div>
									<label><span class="question">Date</span>
										<input type="date" name="Transaction_Date" class=formcontrol  />
									</label>
								</div>
							</div>
						</fieldset>
					</div>
				</div>	
				<div id="Transaction_type_in__ID">
					<div class="formgroup">
						<div class="questiongroup ">
							<fieldset>
								<div class="grid-container-2">
									<div>
										<label><span class="question">Product Date Type</span>
											<select name="Product_Date_Type" id="Product_Date_Type__ID" class=formcontrol>
												<option></option>
												<option>Expiry Date</option>
												<option>Best Before</option>
												<option>Manufacturing Date</option>
											</select>
										</label>
									</div>
									<div>
										<label><span class="question">Product Date</span>
											<input type="date" name="Product_Date" id="Product_Date__ID" class=formcontrol  />
										</label>
									</div>
								</div>
								
							</fieldset>
						</div>
					</div>
				</div>
				<div class="formgroup right">
					<button type="submit" id="submit__ID" class="btn">Submit</button>
				</div>
			</form>
		</div>
	</div>
	<script>
		function F__ID() {
			//-------------------------------------
			VmInclude: '__HOST__/assets/js/form.01.js'
			//-------------------------------------
			var load = m.load;
			m.load = function () {
				load();
				console.log(JSON.stringify(m.input.record))
				if(m.input.record!=undefined){
					$("#F__ID input[name=Ingredients_uid]").val(m.input.record.UID);
					$("#F__ID input[name=Product_Name]").val(m.input.record.I2);
					$("#F__ID input[name=Format]").val(m.input.record.I3);
					$("#F__ID #conversion__ID").text("1 tbsp = "+m.input.record.Data.Tbsp_to_grams+" grams");
				}
				switch($("#F__ID input[name='Transaction_type']:checked").val()){
					case 'Move': 
						$('#quantity__ID').text("Quantity moved from BS to FS");
						$('#Transaction_type_in__ID').hide();
						//$('#F__ID input[name=Product_Date]').val("");
						//$('#F__ID select[name=Product_Date_Type]').val("");
						break;
					case 'Take out':
						$('#quantity__ID').text("Quantity taken from Front Storage");
						$('#Transaction_type_in__ID').show();
						document.getElementById('Product_Date__ID').readOnly=true;
						document.getElementById('Product_Date_Type__ID').disabled=true;
						break;
					case 'Put in':
						$('#quantity__ID').text("Quantity put into Back Storage");
						$('#Transaction_type_in__ID').show();
						document.getElementById('Product_Date__ID').readOnly=false;
						document.getElementById('Product_Date_Type__ID').disabled=false;
						break;
					case 'Stocktake':
						$('#quantity__ID').text("Set Quantity in Front Storage");
						$('#Transaction_type_in__ID').hide();
						break;
					default:
						$('#quantity__ID').text("Quantity");
						$('#Transaction_type_in__ID').hide();
						break;
					}
			}
			//----------------------------------
			m.before_submit = function (data, index) {
				index.I3=data.Transaction_type;
			}
			//-------------------------------------
			$("input[name='Transaction_type']").change(function () {
				switch($("#F__ID input[name='Transaction_type']:checked").val()){
            	case 'Move': 
					$('#quantity__ID').text("Quantity moved from BS to FS");
					$('#Transaction_type_in__ID').hide();
					//$('#F__ID input[name=Product_Date]').val("");
					//$('#F__ID select[name=Product_Date_Type]').val("");
					break;
				case 'Take out':
					$('#quantity__ID').text("Quantity taken from Front Storage");
					$('#Transaction_type_in__ID').show();
					document.getElementById('Product_Date__ID').readOnly=true;
					document.getElementById('Product_Date_Type__ID').disabled=true;
					break;
				case 'Put in':
					$('#quantity__ID').text("Quantity put into Back Storage");
					$('#Transaction_type_in__ID').show();
					document.getElementById('Product_Date__ID').readOnly=false;
					document.getElementById('Product_Date_Type__ID').disabled=false;
					break;
				case 'Stocktake':
					$('#quantity__ID').text("Set Quantity in Front Storage");
					$('#Transaction_type_in__ID').hide();
					break;
				default:
					$('#quantity__ID').text("Quantity");
					$('#Transaction_type_in__ID').hide();
					break;
				}
			})
			//-------------------------------------

			//auto select client
			var get_name = function (record) {
				var name = record.Data.Product_Name;
				return name;
			}
			var get_client_info = function (record) {
				var name = record.Data.Product_Name
				return name;
			}
			var autocomplete_req_1 = { cmd: "find", field: ".I2", table: m.client_table, options: {}, skip: 0, limit: 10 }
			var autocomplete_callback_1 = function (items) {
				$("#F__ID input[name=Ingredients_uid]").val(items["UID"]);
				$("#F__ID input[name=Product_Name]").val(get_client_info(items.record));
				$("#F__ID input[name=Format]").val(items.record.I3);
				console.log(JSON.stringify(items.record));
			}
			var autocomplete_list_1 = function (records) {
				var items = [];
				for (var i = 0; i < records.length; i++) {
					var obj = {};
					obj.label = get_name(records[i]);
					obj['UID'] = records[i].UID;
					obj['record'] = records[i];
					items.push(obj);
				}
				return items;
			}
			var wait1 = function () {
				$vm.autocomplete($('#Product_Name__ID'), autocomplete_req_1, autocomplete_list_1, autocomplete_callback_1);
			}
			var I = 0; var loop_1 = setInterval(function () {
				if ($vm['jquery-ui-min-js'] != undefined) { clearInterval(loop_1); wait1(); }
				I++; if (I > 50) { clearInterval(loop_1); alert("jquery-ui.min.js is not installed."); }
			}, 100);

			//-------------------------------------

		}
	</script>
	<style>
		/*VmInclude:__HOST__/assets/css/wapp-form.css*/
	</style>
</div>